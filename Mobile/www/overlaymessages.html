<div class="messages-content" data-role="popup" id="newMessages" data-history="false" style="right:0;top:27px;padding-bottom:50px;">
  <div class="messagescontent">
      <div class="msg-hideshow">
        <h4>NEW MESSAGES</h4>
        <a href="#" data-bind="click:closePopup"></a>
      </div>
      <section data-bind="foreach: newMessagesDisplayList">
        <a class="messagesreceived" href="#" data-bind="click: $parent.showSingleMessage">
          <span class="igibutton"></span>
          <div class="messageschannel igi-msg-icon">
            <span class="received" data-bind="text: displayFrom"></span>
            <div class="receive-time ellipsis"><em data-bind="text: created"></em> : <span data-bind="text: text"></span></div>
          </div>
          <span class="iconchannels" data-bind="css: escLevelId"></span>
        </a>
      </section>
  </div>
</div>
<script>
	var overlayViewModel = new OverlayViewModel();
	$(".active-overlay").each(function() {
		if($(this).parent().css('display') != 'none') {
			var nonCurrentViewOverlay = "#" + $(this).parent().attr('id');
			if(nonCurrentViewOverlay == '#channelSingleMessagesView') {
				if($('#newMessages-popup').length != 0) {
					$('#newMessages-popup').each(function() {
						$(nonCurrentViewOverlay + " #newMessages-popup").remove();
						$(nonCurrentViewOverlay + " #newMessages-screen").remove();						
					});
				}
			}
			ko.applyBindings(overlayViewModel, document.getElementById('newMessages'));
			overlayViewModel.activate();
		}
		else {
			var nonCurrentViewOverlay = "#" + $(this).parent().attr('id');
			$(nonCurrentViewOverlay + " .active-overlay").html('');
			$(nonCurrentViewOverlay + " #newMessages-popup").remove();
			$(nonCurrentViewOverlay + " #newMessages-screen").remove();
		}	
	});
</script>